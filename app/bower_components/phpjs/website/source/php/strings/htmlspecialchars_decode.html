---
warning: 'This file is auto generated by `npm run web:inject`, do not edit by hand'
examples:
  - 'htmlspecialchars_decode("<p>this -&gt; &quot;</p>", ''ENT_NOQUOTES'')'
  - htmlspecialchars_decode("&amp;quot;")
estarget: es5
returns:
  - '''<p>this -> &quot;</p>'''
  - '''&quot;'''
dependencies: []
authors:
  original by:
    - Mirek Slugen
  improved by:
    - 'Kevin van Zonneveld (http://kvz.io)'
  reimplemented by:
    - 'Brett Zamir (http://brett-zamir.me)'
  bugfixed by:
    - Mateusz "loonquawl" Zalega
    - 'Onno Marsman (https://twitter.com/onnomarsman)'
    - 'Brett Zamir (http://brett-zamir.me)'
    - 'Brett Zamir (http://brett-zamir.me)'
  revised by:
    - 'Kevin van Zonneveld (http://kvz.io)'
  input by:
    - ReverseSyntax
    - Slawomir Kaniecki
    - Scott Cariss
    - Francois
    - Ratheous
    - 'Mailfaker (http://www.weedem.fr/)'
notes: []
type: function
layout: function
title: PHP's htmlspecialchars_decode in JavaScript
description: >-
  Hereâ€™s what our current JavaScript equivalent to <a
  href="http://php.net/manual/en/function.htmlspecialchars_decode.php">PHP's
  htmlspecialchars_decode</a> looks like.
function: htmlspecialchars_decode
category: strings
language: php
permalink: php/strings/htmlspecialchars_decode/
alias:
  - /functions/php/htmlspecialchars_decode/
  - /functions/strings/htmlspecialchars_decode/
  - /php/htmlspecialchars_decode/
  - /functions/htmlspecialchars_decode/
---
{% codeblock lang:javascript %}module.exports = function htmlspecialchars_decode (string, quoteStyle) { // eslint-disable-line camelcase
  //       discuss at: http://locutus.io/php/htmlspecialchars_decode/
  //      original by: Mirek Slugen
  //      improved by: Kevin van Zonneveld (http://kvz.io)
  //      bugfixed by: Mateusz "loonquawl" Zalega
  //      bugfixed by: Onno Marsman (https://twitter.com/onnomarsman)
  //      bugfixed by: Brett Zamir (http://brett-zamir.me)
  //      bugfixed by: Brett Zamir (http://brett-zamir.me)
  //         input by: ReverseSyntax
  //         input by: Slawomir Kaniecki
  //         input by: Scott Cariss
  //         input by: Francois
  //         input by: Ratheous
  //         input by: Mailfaker (http://www.weedem.fr/)
  //       revised by: Kevin van Zonneveld (http://kvz.io)
  // reimplemented by: Brett Zamir (http://brett-zamir.me)
  //        example 1: htmlspecialchars_decode("<p>this -&gt; &quot;</p>", 'ENT_NOQUOTES')
  //        returns 1: '<p>this -> &quot;</p>'
  //        example 2: htmlspecialchars_decode("&amp;quot;")
  //        returns 2: '&quot;'

  var optTemp = 0
  var i = 0
  var noquotes = false

  if (typeof quoteStyle === 'undefined') {
    quoteStyle = 2
  }
  string = string.toString()
    .replace(/&lt;/g, '<')
    .replace(/&gt;/g, '>')
  var OPTS = {
    'ENT_NOQUOTES': 0,
    'ENT_HTML_QUOTE_SINGLE': 1,
    'ENT_HTML_QUOTE_DOUBLE': 2,
    'ENT_COMPAT': 2,
    'ENT_QUOTES': 3,
    'ENT_IGNORE': 4
  }
  if (quoteStyle === 0) {
    noquotes = true
  }
  if (typeof quoteStyle !== 'number') {
    // Allow for a single string or an array of string flags
    quoteStyle = [].concat(quoteStyle)
    for (i = 0; i < quoteStyle.length; i++) {
      // Resolve string input to bitwise e.g. 'PATHINFO_EXTENSION' becomes 4
      if (OPTS[quoteStyle[i]] === 0) {
        noquotes = true
      } else if (OPTS[quoteStyle[i]]) {
        optTemp = optTemp | OPTS[quoteStyle[i]]
      }
    }
    quoteStyle = optTemp
  }
  if (quoteStyle & OPTS.ENT_HTML_QUOTE_SINGLE) {
    // PHP doesn't currently escape if more than one 0, but it should:
    string = string.replace(/&#0*39;/g, "'")
    // This would also be useful here, but not a part of PHP:
    // string = string.replace(/&apos;|&#x0*27;/g, "'");
  }
  if (!noquotes) {
    string = string.replace(/&quot;/g, '"')
  }
  // Put this in last place to avoid escape being double-decoded
  string = string.replace(/&amp;/g, '&')

  return string
}
{% endcodeblock %}